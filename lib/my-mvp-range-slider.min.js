!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("my-mvp-range-slider",[],t):"object"==typeof exports?exports["my-mvp-range-slider"]=t():e["my-mvp-range-slider"]=t()}(window,(function(){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}([function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var i=function(){function e(t){e.validateInitOptions(t)?(this.maxValue=t.maxValue,this.minValue=t.minValue,this.step=t.step):(this.maxValue=10,this.minValue=0,this.step=1),this.observers=new Set,this.value=t.value,void 0!==t.secondValue&&(this.secondValue=t.secondValue),this.lockedValues=new Set,void 0!==t.lockedValues&&this.lockState(t.lockedValues),this.isReadyNotify=!0,this.isUpdated=!0}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){if(this._ableToChange("value",e)){var t=this._value;void 0===this._value&&(this._value=this._minValue);var a=this._getMultipleStep(e);void 0!==this._secondValue&&a>=this._secondValue?(this._value=this._secondValue,this.isUpdated=!1):t!==a&&(this._value=a,this.isUpdated=!1),t!==this._value&&this.notify()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxValue",{get:function(){return this._maxValue},set:function(e){this._ableToChange("maxValue",e)&&(this._maxValue=e,this.isUpdated=!1,void 0!==this._value&&(this.value=this._value),void 0!==this._secondValue&&(this.secondValue=this._secondValue),this.isUpdated||this.notify())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minValue",{get:function(){return this._minValue},set:function(e){this._ableToChange("minValue",e)&&(this._minValue=e,this.isUpdated=!1,void 0!==this._secondValue&&(this.secondValue=this._secondValue),void 0!==this._value&&(this.value=this._value),this.isUpdated||this.notify())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(e){this._ableToChange("step",e)&&(this._step=+e.toFixed(17),this.isUpdated=!1,void 0!==this._value&&(this.value=this._value),void 0!==this._secondValue&&(this.secondValue=this._secondValue),this.isUpdated||this.notify())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondValue",{get:function(){return this._secondValue},set:function(e){if(this._ableToChange("secondValue",e)){var t=this._value,a=this._secondValue;if(void 0!==e){var i=this._getMultipleStep(e);i<=t?(this._secondValue=t,this.isUpdated=a===t):a!==i&&(this._secondValue=i,this.isUpdated=!1)}else this._secondValue=void 0,this.isUpdated=void 0===a;a!==this._secondValue&&this.notify()}},enumerable:!0,configurable:!0}),e.prototype.addObserver=function(e){this.observers.add(e)},e.prototype.removeObserver=function(e){this.observers.delete(e)},e.prototype.getState=function(){var e={maxValue:this._maxValue,minValue:this._minValue,value:this._value,step:this._step,lockedValues:Array.from(this.lockedValues)};return void 0!==this._secondValue&&(e.secondValue=this._secondValue),e},e.prototype.updateState=function(e){var t=this.getState(),a=t.maxValue,i=t.minValue;this.isReadyNotify=!1,Object.prototype.hasOwnProperty.call(e,"unlockValues")&&this.unlockState(e.unlockValues);var s=this.createNewState(e);s.maxValue>s.minValue&&(this._maxValue=s.maxValue,this._minValue=s.minValue),this.step=s.step,this.value=s.value,(Object.prototype.hasOwnProperty.call(e,"secondValue")||void 0!==this.secondValue)&&(this.secondValue=s.secondValue),Object.prototype.hasOwnProperty.call(s,"lockedValues")&&this.lockState(s.lockedValues),this.isReadyNotify=!0,a===this.maxValue&&i===this.minValue||(this.isUpdated=!1),this.isUpdated||this.notify()},e.prototype.lockState=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){switch(e){case"minValue":t.lockedValues.add("minValue"),t.isUpdated=!1;break;case"maxValue":t.lockedValues.add("maxValue"),t.isUpdated=!1;break;case"step":t.lockedValues.add("step"),t.isUpdated=!1;break;case"value":t.lockedValues.add("value"),t.isUpdated=!1;break;case"secondValue":t.lockedValues.add("secondValue"),t.isUpdated=!1}})):"all"===e&&(this.lockedValues.add("maxValue"),this.lockedValues.add("minValue"),this.lockedValues.add("step"),this.lockedValues.add("value"),this.lockedValues.add("secondValue"),this.isUpdated=!1),this.isUpdated||this.notify()},e.prototype.unlockState=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){switch(e){case"minValue":t.lockedValues.delete("minValue"),t.isUpdated=!1;break;case"maxValue":t.lockedValues.delete("maxValue"),t.isUpdated=!1;break;case"step":t.lockedValues.delete("step"),t.isUpdated=!1;break;case"value":t.lockedValues.delete("value"),t.isUpdated=!1;break;case"secondValue":t.lockedValues.delete("secondValue"),t.isUpdated=!1}})):"all"===e&&(this.lockedValues.clear(),this.isUpdated=!1),this.isUpdated||this.notify()},e.prototype.notify=function(){this._checkObservers()&&this.isReadyNotify&&(this.observers.forEach((function(e){e.update()})),this.isUpdated=!0)},e.prototype._checkObservers=function(){return void 0!==this.observers&&0!==this.observers.size},e.prototype._getMultipleStep=function(t){var a,i,s=this._step,n=this._maxValue,r=this._minValue;switch(!0){case t>=n:a=n;break;case t<=r:a=r;break;case(t-r)%s/s>.5:a=(i=t-(t-r)%s+s)>n?n:i;break;default:a=(i=t-(t-r)%s)+s>=n&&(n+i)/2<t?n:t-(t-r)%s}return e.fixVal(a,s)},e.prototype._isLocked=function(e){return void 0!==this.lockedValues&&this.lockedValues.has(e)},e.prototype._ableToChange=function(t,a){var i,s,n,r,o=e._validate(a),l=this._isLocked(t);switch(t){case"value":return o&&!l;case"secondValue":return void 0===a||o&&!l;case"maxValue":return i=a===this._maxValue,s=void 0===this._maxValue,n=void 0===this._minValue||a>this._minValue,s||o&&!l&&!i&&n;case"minValue":return i=a===this._minValue,s=void 0===this._minValue,r=void 0===this._maxValue||a<this._maxValue,s||o&&!l&&!i&&r;case"step":return i=a===this._step,(s=void 0===this._step)||o&&!l&&!i&&a>0;default:return!1}},e.prototype.createNewState=function(e){var t=this.getState(),a=t.maxValue,i=t.minValue,s=t.step,n=t.value,r=t.secondValue,o=$.extend(this.getState(),e);return Object.prototype.hasOwnProperty.call(e,"secondValue")&&(o.secondValue=e.secondValue),o.maxValue=this._isLocked("maxValue")?a:o.maxValue,o.minValue=this._isLocked("minValue")?i:o.minValue,o.step=this._isLocked("step")?s:o.step,o.value=this._isLocked("value")?n:o.value,o.secondValue=this._isLocked("secondValue")?r:o.secondValue,o},e._validate=function(e){return!(null===e||Number.isNaN(e)||!Number.isFinite(e))},e.validateInitOptions=function(e){var t=Object.prototype.hasOwnProperty.call(e,"maxValue"),a=Object.prototype.hasOwnProperty.call(e,"minValue"),i=Object.prototype.hasOwnProperty.call(e,"step"),s=e.maxValue>e.minValue,n=e.step>0;return t&&a&&i&&s&&n},e.fixVal=function(e,t){if(!(t%1))return+e.toFixed(0);var a=(""+t).split(".")[1].length;return+e.toFixed(a)},e}(),s=function(){return(s=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},n=function(){function e(e){this.model=e.model,this.view=e.view,this.callbacks={onStart:e.onStart,onChange:e.onChange,onFinish:e.onFinish,onUpdate:e.onUpdate},this.subscribeToModel(),this.subscribeToView(),this.dataValues=e.dataValues||[],this.isChanging=!1,this.isReadyRender=!0,this.renderView()}return e.prototype.update=function(t){this.isReadyRender=!1;var a=t.dataValues,i={maxValue:t.maxValue,minValue:t.minValue,step:t.step,value:t.value,lockedValues:t.lockedValues,unlockValues:t.unlockValues};Object.prototype.hasOwnProperty.call(t,"secondValue")&&(i.secondValue=t.secondValue);var n={isHorizontal:t.isHorizontal,range:t.range,dragInterval:t.dragInterval,runner:t.runner,bar:t.bar,scale:t.scale,numOfScaleVal:t.numOfScaleVal,displayScaleValue:t.displayScaleValue,displayValue:t.displayValue,displayMin:t.displayMin,displayMax:t.displayMax,prefix:t.prefix,postfix:t.postfix};a&&(a.length>1?(this.dataValues=a,i=s(s({},i),{unlockValues:"all",maxValue:a.length-1,minValue:0,step:1,lockedValues:["maxValue","minValue","step"]}),n=s(s({},n),{numOfScaleVal:a.length-2})):(this.dataValues=[],this.model.unlockState(["maxValue","minValue","step"]))),e.isEmpty(i)&&!Object.prototype.hasOwnProperty.call(t,"secondValue")||this.model.updateState(i),e.isEmpty(n)||this.view.update(n),t.onStart&&"function"==typeof t.onStart&&(this.callbacks.onStart=t.onStart),t.onChange&&"function"==typeof t.onChange&&(this.callbacks.onChange=t.onChange),t.onFinish&&"function"==typeof t.onFinish&&(this.callbacks.onFinish=t.onFinish),t.onUpdate&&"function"==typeof t.onUpdate&&(this.callbacks.onUpdate=t.onUpdate),this.callbacks.onUpdate(),this.isReadyRender=!0,this.renderView()},e.prototype.getPresenterData=function(){return{dataValues:this.dataValues}},e.prototype.setUserData=function(e){Array.isArray(e)&&e.length>1&&(this.dataValues=e,this.update({unlockValues:"all",maxValue:e.length-1,minValue:0,step:1,lockedValues:["maxValue","minValue","step"],numOfScaleVal:e.length-2}))},e.prototype.createDataValues=function(e,t){var a,i=e||this.model.getState(),s=i.minValue,n=i.maxValue,r=i.step,o=t||this.view.getData(),l=o.displayMax,u=void 0===l||l,d=o.displayMin,h=void 0===d||d,c=o.numOfScaleVal,p=void 0===c?10:c,v=[];h&&v.push(s);var f=(n-s)/r,y=p<(a=f%1==0?f-1:Math.floor(f))?p:a;if(y<=0&&(y=0),y>=10&&(y=10),y===a)for(var V=1;V<=a;V+=1){var g=s+r*V;v.push(g)}else{var m=(n-s)/(y+1);for(V=1;V<=y;V+=1){var $=void 0;$=((g=s+m*V)-s)%r>r/2?g-(g-s)%r+r:g-(g-s)%r,v.push($)}}return u&&v.push(n),v},e.prototype.createPercentageData=function(e){var t=this.model.getState(),a=t.minValue,s=t.maxValue,n=t.step/(s-a);return e.map((function(e){var t=(e-a)/(s-a)*100;return i.fixVal(t,n)}))},e.prototype.createRenderData=function(){var e,t,a=this,i=this.model.getState(),s=i.value,n=i.secondValue;void 0!==n?(e=this.dataValues.length>0?[this.dataValues[s],this.dataValues[n]]:[s,n],t=[this.convertValueToPercent(s),this.convertValueToPercent(n)]):(e=this.dataValues.length>0?this.dataValues[s]:s,t=this.convertValueToPercent(s));var r=this.createDataValues(),o=this.createPercentageData(r);return{data:this.dataValues.length?r.map((function(e){return a.dataValues[e]})):r,percentageData:o,value:e,percentage:t}},e.prototype.subscribeToModel=function(){var e=this;this.modelObserver={update:function(){var t=e.model.getState();e.isChanging&&e.callbacks.onChange(t),e.renderView()}},this.model.addObserver(this.modelObserver)},e.prototype.subscribeToView=function(){var e=this;this.viewObserver={start:function(){e.callbacks.onStart(e.model.getState())},change:function(t){e.isChanging=!0;var a=e.convertPercentToValue(t);if(Array.isArray(a)){var i=a[0],s=a[1];e.model.updateState({value:i,secondValue:s})}else e.model.updateState({value:a})},finish:function(){e.callbacks.onFinish(e.model.getState())},update:function(){e.renderView()}},this.view.addObserver(this.viewObserver)},e.prototype.renderView=function(){if(this.isReadyRender){var e=this.createRenderData();this.view.render(e)}},e.prototype.convertPercentToValue=function(e){var t,a=this.model.getState(),i=a.minValue,s=a.maxValue;Array.isArray(e)?t=[(s-i)/100*e[0]+i,(s-i)/100*e[1]+i]:t=(s-i)/100*e+i;return t},e.prototype.convertValueToPercent=function(e){var t=this.model.getState(),a=t.minValue,s=t.maxValue,n=t.step/(s-a),r=(e-a)/(s-a)*100;return i.fixVal(r,n)},e.isEmpty=function(e){var t=Object.entries(e),a=!0;return t.forEach((function(e){void 0!==e[1]&&(a=!1)})),a},e}(),r=(a(0),a(1),function(){return(r=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),o=function(){function e(t){this.$view=t.$viewContainer,this.$scale=e.createScale(),this.isRendered=!1}return e.prototype.update=function(t){var a=this.$scale.data("options"),i=t.data,s=t.options,n=r(r(r({},{isHorizontal:!0,displayScaleValue:!0,displayMin:!0,displayMax:!0,numOfScaleVal:3}),a),s);this.$scale.data("data",i),this.$scale.data("options",n);var o=n.isHorizontal,l=n.displayScaleValue;o&&!this.$scale.hasClass("slider__scale_horizontal")&&this.$scale.addClass("slider__scale_horizontal"),!o&&this.$scale.hasClass("slider__scale_horizontal")&&this.$scale.removeClass("slider__scale_horizontal"),this.isRendered||(this.$view.append(this.$scale),this.attachEventHandlers(),this.isRendered=!0);var u=i.data,d=i.percentageData;if(this.$scale.empty(),l)for(var h=u.length,c=0;c<=h-1;c+=1){var p=u[c].toString(),v=d[c],f=e.createElement(p,v,n);this.$scale.append(f),e.positionElem(f,n)}var y=0;this.$scale.find(".scale__element").each((function(){if(o){var e=this.getBoundingClientRect().height;y=y>e?y:e}else{var t=this.getBoundingClientRect().width;y=y>t?y:t}})),o?this.$scale.css({height:y+"px",width:"100%"}):this.$scale.css({width:y+"px",height:"100%"})},e.prototype.destroy=function(){this.$scale.off("click"),this.$scale.remove(),this.isRendered=!1},e.prototype.attachEventHandlers=function(){this.$scale.on("click",this.clickEventListener.bind(this))},e.prototype.clickEventListener=function(e){var t,a=e.target;if(a.classList.contains("scale__element")){t=$(a).data("percentage");var i=$.Event("startChanging.myMVPSlider");this.$view.trigger(i);var s=this.$scale.data("data").percentage,n=!1;if(Array.isArray(s))n=t>(s[1]+s[0])/2;var r=[t,n],o=$.Event("changeValue.myMVPSlider");this.$view.trigger(o,r);var l=$.Event("finish.myMVPSlider");this.$view.trigger(l,r)}},e.createScale=function(){return $("<div>",{class:"js-slider__scale slider__scale"})},e.createElement=function(e,t,a){var i=$("<span>",{class:"scale__element"});return i.html(e),i.data("percentage",t),a.isHorizontal&&i.addClass("scale__element_horizontal"),i},e.positionElem=function(e,t){var a=e.data("percentage"),i=e[0].getBoundingClientRect();if(t.isHorizontal)switch(a){case 0:e.css({left:"calc(0% - 0.75rem)"});break;case 100:e.css({right:"calc(0% - 0.75rem)","align-items":"flex-end"});break;default:e.css({left:"calc("+a+"% - "+i.width/2+"px)","align-items":"center"})}else e.css({"padding-left":"0.8rem",top:"calc("+a+"% - "+i.height/2+"px)"})},e}(),l=(a(2),function(){return(l=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),u=function(){function e(t){this.$view=t.$viewContainer,this.$barContainer=t.$barContainer,this.$bar=e.createBar(),this.isRendered=!1}return e.prototype.update=function(e){var t=this.$bar.data("options"),a=e.options,i=e.data,s=l(l(l({},{isHorizontal:!0,range:!0,dragInterval:!1}),t),a);this.$bar.data("options",s),this.$bar.data("data",i),!s.isHorizontal&&this.$bar.hasClass("slider__bar_horizontal")?this.$bar.removeClass("slider__bar_horizontal"):s.isHorizontal&&!this.$bar.hasClass("slider__bar_horizontal")&&this.$bar.addClass("slider__bar_horizontal"),s.range&&this.createRangeElement(),!s.range&&this.$range&&this.destroyRangeElement(),this.isRendered||(this.$barContainer.append(this.$bar),this.isRendered=!0,this.attachEventHandlers())},e.prototype.destroy=function(){this.$bar.off("click"),this.$bar.remove(),this.isRendered=!1},e.prototype.attachEventHandlers=function(){this.$bar.on("click",this.clickHandler.bind(this))},e.prototype.clickHandler=function(e){var t,a=$.Event("startChanging.myMVPSlider");this.$view.trigger(a);var i=e.currentTarget,s=i.getBoundingClientRect();t=$(i).data("options").isHorizontal?(e.clientX-s.x)/s.width*100:(e.clientY-s.y)/s.height*100;var n=$(i).data("data"),r=!1;Array.isArray(n)&&(r=t>(n[1]+n[0])/2);var o=[t,r],l=$.Event("changeValue.myMVPSlider");this.$view.trigger(l,o);var u=$.Event("finish.myMVPSlider");this.$view.trigger(u,o)},e.prototype.createRangeElement=function(){var e=this.$bar.data(),t=e.options,a=e.data;if(this.$range||(this.$range=$("<div>",{class:"slider__range"}),this.$range.data("have-handler",!1),this.$bar.append(this.$range)),t.isHorizontal)if(this.$range.css({top:"",height:""}),Array.isArray(a)){var i=a[0],s=a[1];this.$range.css({left:i+"%",width:s-i+"%","border-radius":"0.75rem"})}else this.$range.css({left:0,width:a+"%","border-top-left-radius":"0.75rem","border-bottom-left-radius":"0.75rem"});else if(Array.isArray(a)){i=a[0],s=a[1];this.$range.css({left:"",width:"",top:i+"%",height:s-i+"%","border-radius":"0.75rem"})}else this.$range.css({width:"",top:"",height:a+"%","border-top-left-radius":"0.75rem","border-top-right-radius":"0.75rem"});var n=this.$range.data("have-handler"),r=t.dragInterval&&Array.isArray(a);r&&!n&&(this.$range.css({cursor:"grab"}),this.$range.on("mousedown.bar",this.dragStartHandler.bind(this)),this.$range.data("have-handler",!0),this.$range[0].onclick=function(e){e.stopPropagation()},this.$range.on("dragstart.bar",!1)),!r&&n&&(this.$range.css({cursor:"default"}),this.$range.off("mousedown.bar"),this.$range.data("have-handler",!1),this.$range[0].onclick=null,this.$range.off("dragstart.bar"))},e.prototype.dragStartHandler=function(e){var t,a=this;this.$range.css({cursor:"grabbing"});var i=this.$view[0].getBoundingClientRect();t=this.$bar.data("options").isHorizontal?(e.clientX-i.x)/i.width*100:(e.clientY-i.y)/i.height*100;var s=$.Event("startChanging.myMVPSlider");this.$view.trigger(s,[!0]);var n=this.makeDragHandler(t);this.$view.on("mousemove.bar",n),document.onmouseup=function(){a.$view.off("mousemove.bar",n),a.$range.css({cursor:"grab"});var e=$.Event("dropRange.myMVPSlider");a.$view.trigger(e),document.onmouseup=null}},e.prototype.makeDragHandler=function(e){var t=this;return function(a){var i=t.$view[0].getBoundingClientRect(),s=(t.$bar.data("options").isHorizontal?(a.clientX-i.x)/i.width*100:(a.clientY-i.y)/i.height*100)-e,n=$.Event("dragRange.myMVPSlider");t.$view.trigger(n,[s])}},e.prototype.destroyRangeElement=function(){this.$range.remove(),this.$range=null},e.createBar=function(){return $("<div>",{class:"js-slider__bar slider__bar"})},e}(),d=(a(3),function(){return(d=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),h=function(){function e(t){this.$barContainer=t.$barContainer,this.$view=t.$viewContainer,this.$runner=e.createRunner(),this.isRendered=!1,this.isSecond=!0===t.isSecond}return e.prototype.update=function(e){var t=e.data,a=e.options,i=this.$runner.data("options"),s=d(d(d({},{isHorizontal:!0}),i),a);s.isHorizontal&&!this.$runner.hasClass("slider__runner_horizontal")&&this.$runner.addClass("slider__runner_horizontal"),!s.isHorizontal&&this.$runner.hasClass("slider__runner_horizontal")&&this.$runner.removeClass("slider__runner_horizontal"),this.isSecond?this.$runner.addClass("runner_second"):this.$runner.addClass("runner_first"),this.isRendered||(this.$barContainer.append(this.$runner),this.attacheEventHandlers(),this.isRendered=!0);var n,r,o=this.$runner[0].getBoundingClientRect().width;if(Array.isArray(t.percentage)&&Array.isArray(t.value)){var l=t.value,u=l[0],h=l[1],c=t.percentage,p="calc("+c[0]+"% - "+o/2+"px)",v="calc("+c[1]+"% - "+o/2+"px)";n=this.isSecond?h:u,r=this.isSecond?v:p}Array.isArray(t.percentage)||Array.isArray(t.value)||(n=t.value,r="calc("+t.percentage+"% - "+o/2+"px)"),this.$runner.data("options",s),this.$runner.data("value",n),a.isHorizontal?(this.$runner.css("top",""),this.$runner.css({left:r})):(this.$runner.css("left",""),this.$runner.css({top:r}))},e.prototype.destroy=function(){this.$runner.off("mousedown.runner"),this.$view.off("mousemove.runner"),this.$runner.remove(),this.isRendered=!1},e.prototype.attacheEventHandlers=function(){this.$runner.on("mousedown.runner",this.dragStartHandler.bind(this)),this.$runner.on("dragstart",!1)},e.prototype.dragStartHandler=function(e){var t=this,a=$.Event("startChanging.myMVPSlider");this.$view.trigger(a);var i=e.currentTarget,s=$(i).data("options");this.$runner.css("cursor","grabbing");var n=this.makeHandler(s);this.$view.on("mousemove.runner",n),document.onmouseup=function(){t.$view.off(".runner"),t.$runner.css("cursor","grab");var e=$.Event("finish.myMVPSlider");t.$view.trigger(e),document.onmouseup=null}},e.prototype.makeHandler=function(e){var t,a,i=this,s=this.$barContainer[0].getBoundingClientRect();return function(n){e.isHorizontal?(t=n.clientX-s.x,a=t/s.width*100):(t=n.clientY-s.y,a=t/s.height*100);var r=$.Event("changeValue.myMVPSlider");i.$view.trigger(r,[a,i.isSecond])}},e.createRunner=function(){return $("<div>",{class:"js-slider__runner slider__runner"})},e}(),c=(a(4),function(){return(c=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),p=function(){function e(t){this.$view=t.$viewContainer,this.$displayContainer=e.createValuesDisplayContainer(),this.isRendered=!1}return e.prototype.update=function(t){var a=t.data,i=t.options,s=this.$displayContainer.data("options"),n=c(c(c({},{isHorizontal:!0,prefix:"",postfix:""}),s),i);this.$displayContainer.data({options:n,data:a.value}),this.$firstValDisplay||(this.$firstValDisplay=e.createValueDisplay(),this.$displayContainer.append(this.$firstValDisplay)),Array.isArray(a.value)?(this.$secondValDisplay||(this.$secondValDisplay=e.createValueDisplay(),this.$displayContainer.append(this.$secondValDisplay)),i.isHorizontal&&!this.$secondValDisplay.hasClass("slider__display_value_horizontal")&&this.$secondValDisplay.addClass("slider__display_value_horizontal"),!i.isHorizontal&&this.$secondValDisplay.hasClass("slider__display_value_horizontal")&&this.$secondValDisplay.removeClass("slider__display_value_horizontal")):this.$secondValDisplay&&(this.$secondValDisplay.remove(),this.$secondValDisplay=null),i.isHorizontal&&!this.$displayContainer.hasClass("slider__display_container_horizontal")&&(this.$displayContainer.addClass("slider__display_container_horizontal"),this.$firstValDisplay.addClass("slider__display_value_horizontal")),!i.isHorizontal&&this.$displayContainer.hasClass("slider__display_container_horizontal")&&(this.$displayContainer.removeClass("slider__display_container_horizontal"),this.$firstValDisplay.removeClass("slider__display_value_horizontal")),this.isRendered||(this.$view.prepend(this.$displayContainer),this.isRendered=!0),this.updateValueDisplay({data:a,options:n})},e.prototype.destroy=function(){this.$displayContainer.remove(),this.$firstValDisplay&&(this.$firstValDisplay.remove(),this.$firstValDisplay=null),this.$secondValDisplay&&(this.$secondValDisplay.remove(),this.$secondValDisplay=null),this.isRendered=!1},e.prototype.updateValueDisplay=function(e){var t,a,i,s,n,r=e.data,o=e.options,l=r.value,u=r.percentage,d=o.isHorizontal;if(Array.isArray(u)&&Array.isArray(l)){t=u[0],a=u[1],s=l[0],n=l[1],this.$secondValDisplay.data("data",n),this.$secondValDisplay.data("options",o);var h=o.prefix;h+=n.toString(),""!==o.postfix&&(h+=o.postfix),this.$secondValDisplay.html(h),i=this.$secondValDisplay[0].getBoundingClientRect(),this.$firstValDisplay.data("data",s),this.$firstValDisplay.data("options",o)}Array.isArray(u)||Array.isArray(l)||(t=u,s=l,this.$firstValDisplay.data("data",s),this.$firstValDisplay.data("options",o));var c=o.prefix;c+=s.toString(),""!==o.postfix&&(c+=o.postfix),this.$firstValDisplay.html(c);var p,v,f=this.$firstValDisplay[0].getBoundingClientRect();if(d){p="calc("+t+"% - "+f.width/2+"px)",this.$firstValDisplay.css({top:"",left:p});var y=this.$firstValDisplay[0].getBoundingClientRect(),V=y.x,g=y.width,m=this.$view[0].getBoundingClientRect(),$=m.x,b=m.width;if(V<$&&this.$firstValDisplay.css({left:"calc(0% - 0.75rem)"}),V+g>$+b&&this.$firstValDisplay.css({left:"calc("+(b-g)+"px - 0.75rem)"}),this.$secondValDisplay){v="calc("+a+"% - "+i.width/2+"px)",this.$secondValDisplay.css({top:"",left:v});var _=this.$secondValDisplay[0].getBoundingClientRect(),w=_.x,x=_.width;w+x>$+b&&this.$secondValDisplay.css({left:"calc("+(b-x)+"px - 0.75rem)"})}}else{p="calc("+t+"% - "+f.height/2+"px)",this.$firstValDisplay.css({left:"",top:p});var C=this.$firstValDisplay[0].getBoundingClientRect(),O=C.y,S=C.height,k=this.$view[0].getBoundingClientRect(),D=k.y,R=k.height;if(O<D&&this.$firstValDisplay.css({top:"calc(0% - 0.75rem)"}),O+S>D+R&&this.$firstValDisplay.css({top:"calc("+(R-S)+"px - 0.75rem)"}),this.$secondValDisplay){v="calc("+a+"% - "+i.height/2+"px)",this.$secondValDisplay.css({left:"",top:v});var P=this.$secondValDisplay[0].getBoundingClientRect(),z=P.y,H=P.height;z+H>D+R&&this.$secondValDisplay.css({top:"calc("+(R-H)+"px - 0.75rem)"})}}},e.createValuesDisplayContainer=function(){return $("<div>",{class:"js-slider__display_container slider__display_container"})},e.createValueDisplay=function(){return $("<div>",{class:"slider__display_value"})},e}(),v=function(){return(v=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},f=function(){function e(e,t){this.$container=$(e),this.viewOptions=t,this.observers=new Set,this.$view=this.createView(),this.$barContainer=$("<div>",{class:"slider__bar_container"}),this.$view.append(this.$barContainer),this.isRendered=!1}return e.prototype.render=function(e){void 0===e&&(e=this.renderData),this.renderData=e,this.viewOptions.isHorizontal&&!this.$view.hasClass("slider__container_horizontal")&&(this.$view.addClass("slider__container_horizontal"),this.$barContainer.addClass("slider__bar_container_horizontal")),!this.viewOptions.isHorizontal&&this.$view.hasClass("slider__container_horizontal")&&(this.$view.removeClass("slider__container_horizontal"),this.$barContainer.removeClass("slider__bar_container_horizontal")),this.isRendered||(this.$container.append(this.$view),this.attachEventHandlers(),this.isRendered=!0),this.updateValuesDisplay(e),this.updateScale(e),this.updateBar(e.percentage),this.updateRunners(e)},e.prototype.update=function(e){var t=v(v({},this.viewOptions),this.validateData(e));this.viewOptions=t,this.$view.data("options",t),this.notify({event:"update"})},e.prototype.addObserver=function(e){this.observers.add(e)},e.prototype.removeObserver=function(e){this.observers.delete(e)},e.prototype.getData=function(){return this.viewOptions},e.prototype.destroy=function(){this.bar&&(this.bar.destroy(),this.bar=null),this.scale&&(this.scale.destroy(),this.scale=null),this.runner&&(this.runner.destroy(),this.runner=null),this.secondRunner&&(this.secondRunner.destroy(),this.secondRunner=null),this.valueDisplay&&(this.valueDisplay.destroy(),this.valueDisplay=null),this.$view.remove(),this.isRendered=!1},e.prototype.createView=function(){var e=this.viewOptions,t=$("<div>",{class:"js-slider__container slider__container"});return t.data("options",e),t},e.prototype.updateBar=function(e){this.viewOptions.bar&&this.bar&&this.bar.update({data:e,options:this.viewOptions}),this.viewOptions.bar&&!this.bar&&(this.bar=new u({$viewContainer:this.$view,$barContainer:this.$barContainer}),this.bar.update({data:e,options:this.viewOptions})),!this.viewOptions.bar&&this.bar&&this.bar.destroy()},e.prototype.updateScale=function(e){this.viewOptions.scale&&this.scale&&this.scale.update({data:e,options:this.viewOptions}),this.viewOptions.scale&&!this.scale&&(this.scale=new o({$viewContainer:this.$view}),this.scale.update({data:e,options:this.viewOptions})),!this.viewOptions.scale&&this.scale&&this.scale.destroy()},e.prototype.updateValuesDisplay=function(e){var t={data:e,options:this.viewOptions};this.viewOptions.displayValue&&this.valueDisplay&&this.valueDisplay.update(t),this.viewOptions.displayValue&&!this.valueDisplay&&(this.valueDisplay=new p({$viewContainer:this.$view}),this.valueDisplay.update(t)),!this.viewOptions.displayValue&&this.valueDisplay&&(this.valueDisplay.destroy(),this.valueDisplay=null)},e.prototype.updateRunners=function(e){var t={data:e,options:this.viewOptions};this.viewOptions.runner?Array.isArray(e.value)?(this.runner||(this.runner=new h({$viewContainer:this.$view,$barContainer:this.$barContainer,isSecond:!1})),this.runner.update(t),this.secondRunner||(this.secondRunner=new h({$viewContainer:this.$view,$barContainer:this.$barContainer,isSecond:!0})),this.secondRunner.update(t)):(this.runner||(this.runner=new h({$viewContainer:this.$view,$barContainer:this.$barContainer,isSecond:!1})),this.runner.update(t),this.secondRunner&&(this.secondRunner.destroy(),this.secondRunner=null)):(this.runner&&(this.runner.destroy(),this.runner=null),this.secondRunner&&(this.secondRunner.destroy(),this.runner=null))},e.prototype.notify=function(e){switch(e.event){case"start":this.observers.forEach((function(e){e.start()}));break;case"change":this.observers.forEach((function(t){t.change(e.value)}));break;case"finish":this.observers.forEach((function(e){e.finish()}));break;case"update":this.observers.forEach((function(e){e.update()}))}},e.prototype.attachEventHandlers=function(){this.$view.bind("startChanging.myMVPSlider",this.startChangingHandler.bind(this)),this.$view.bind("changeValue.myMVPSlider",this.changeValueHandler.bind(this)),this.$view.bind("finish.myMVPSlider",this.finishEventHandler.bind(this)),this.$barContainer.on("dragstart",!1)},e.prototype.startChangingHandler=function(e,t){this.notify({event:"start"});var a=this.renderData.percentage;if(t&&Array.isArray(a)){var i=this.makeDragHandler(a),s=this.makeDropHandler();this.$view.bind("dragRange.myMVPSlider",i),this.$view.bind("dropRange.myMVPSlider",s)}},e.prototype.makeDragHandler=function(e){var t=this;return function(a,i){var s=e[1]-e[0],n=e[0]+i,r=e[1]+i;n<0&&(r=(n=0)+s),r>100&&(n=(r=100)-s);var o={event:"change",value:[n,r]};t.notify(o)}},e.prototype.makeDropHandler=function(){var e=this;return function(){e.notify({event:"finish"}),e.$view.unbind("dragRange.myMVPSlider",!1),e.$view.unbind("dropRange.myMVPSlider",!1)}},e.prototype.changeValueHandler=function(e,t,a){var i,s=this.renderData.percentage;i=a&&Array.isArray(s)?{event:"change",value:[s[0],t]}:Array.isArray(s)?{event:"change",value:[t,s[1]]}:{event:"change",value:t},this.notify(i)},e.prototype.finishEventHandler=function(){this.notify({event:"finish"})},e.prototype.validateData=function(t){var a=this;return Object.entries(t).map((function(t){var i=t[0];switch(i){case"isHorizontal":case"range":case"dragInterval":case"runner":case"bar":case"scale":case"displayScaleValue":case"displayValue":case"displayMin":case"displayMax":if("boolean"==typeof t[1])return t;break;case"numOfScaleVal":if(e.isValidNumOfValue(t[1]))return t;break;case"prefix":case"postfix":if("string"==typeof t[1])return t;break;default:return}return[i,a.viewOptions[i]]})).reduce((function(e,t){var a,i=t[0],s=t[1];return v(v({},e),((a={})[i]=s,a))}),{})},e.isValidNumOfValue=function(e){return"number"==typeof e&&(Number.isFinite(e)&&e>=0&&e<=10)},e}(),y=function(){return(y=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},V=function(){function e(e,t){this.initOptions=e,this.node=t,this.createModel(),this.createView(),this.createPresenter()}return e.prototype.update=function(e){this.options=y(y(y({},this.initOptions),this.options),e),this.presenter.update(e)},e.prototype.setUserData=function(e){e.length>1?this.presenter.setUserData(e):this.reset()},e.prototype.getAllData=function(){return y(y(y({},this.getModelData()),this.getViewData()),this.getPresenterData())},e.prototype.getModelData=function(){return this.model.getState()},e.prototype.getViewData=function(){return this.view.getData()},e.prototype.getPresenterData=function(){return this.presenter.getPresenterData()},e.prototype.lockValues=function(e){this.presenter.update({lockedValues:e})},e.prototype.unlockValues=function(e){this.presenter.update({unlockValues:e})},e.prototype.reset=function(){this.options=this.initOptions,this.presenter.update(this.initOptions)},e.prototype.destroy=function(){this.view.destroy()},e.prototype.createModel=function(){var e=this.initOptions,t=e.maxValue,a=e.minValue,s=e.step,n=e.value,r=e.secondValue;this.model=new i({maxValue:t,minValue:a,step:s,value:n,secondValue:r})},e.prototype.createPresenter=function(){var e=this.initOptions,t=e.dataValues,a=e.onStart,i=e.onChange,s=e.onFinish,r=e.onUpdate;this.presenter=new n({model:this.model,view:this.view,dataValues:t,onStart:a,onChange:i,onFinish:s,onUpdate:r})},e.prototype.createView=function(){var e=this.initOptions,t=e.isHorizontal,a=e.range,i=e.dragInterval,s=e.runner,n=e.bar,r=e.scale,o=e.displayScaleValue,l=e.displayValue,u=e.numOfScaleVal,d=e.displayMin,h=e.displayMax,c=e.prefix,p=e.postfix;this.view=new f(this.node,{isHorizontal:t,range:a,dragInterval:i,runner:s,bar:n,scale:r,displayScaleValue:o,displayValue:l,numOfScaleVal:u,displayMin:d,displayMax:h,prefix:c,postfix:p})},e}(),g=function(){return(g=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};!function(e){e.fn.myMVPSlider=function(t){var a={maxValue:100,minValue:0,step:1,value:0,secondValue:void 0,isHorizontal:!0,range:!0,dragInterval:!1,runner:!0,bar:!0,scale:!0,numOfScaleVal:3,displayScaleValue:!0,displayValue:!0,displayMin:!0,displayMax:!0,prefix:"",postfix:"",dataValues:[],onStart:function(){},onChange:function(){},onFinish:function(){},onUpdate:function(){}};if("destroy"===t)this.each((function(){var t=e(this).data("myMVPSlider");t&&(t.destroy(),e(this).data({myMVPSlider:void 0,"init-options":void 0}))}));else{if(t){var i=Object.entries(t).map((function(e){var t=e[0];switch(t){case"maxValue":case"minValue":case"step":case"value":case"secondValue":if(null===e[1]||Number.isNaN(e[1]))break;return e;case"isHorizontal":case"range":case"dragInterval":case"runner":case"bar":case"scale":case"displayScaleValue":case"displayValue":case"displayMin":case"displayMax":if("boolean"==typeof e[1])return e;break;case"numOfScaleVal":if("number"==typeof e[1]&&e[1]>=0)return e;break;case"prefix":case"postfix":if("string"==typeof e[1])return e;break;case"dataValues":if(Array.isArray(e[1]))return e;break;case"onStart":case"onChange":case"onFinish":case"onUpdate":if("function"==typeof e[1])return e;break;default:return e}return[t,a[t]]})).reduce((function(e,t){var a,i=t[0],s=t[1];return g(g({},e),((a={})[i]=s,a))}),{});a=e.extend(a,i)}this.each((function(){var t=e(this),i=new V(a,this);t.data("myMVPSlider",i),t.data("init-options",a)}))}return this}}(jQuery)}])}));